<!DOCTYPE html>
<html>
<head>
  <title>NS SIDD TUTORIAL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Basic reset and font */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background: #f5f7fa;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    /* Top Bar */
    #top-bar {
      background: linear-gradient(90deg, #4b6cb7, #182848);
      color: white;
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      width: 100%;
      top: 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      z-index: 1000;
      font-weight: 600;
    }
    #logo {
      display: flex;
      align-items: center;
      font-size: 22px;
      letter-spacing: 1.2px;
    }
    #logo img {
      height: 42px;
      margin-right: 14px;
      filter: drop-shadow(0 0 3px rgba(255,255,255,0.8));
    }
    #profile-info {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 16px;
    }
    #student-name {
      font-weight: 700;
    }
    #profile-img {
      height: 44px;
      width: 44px;
      border-radius: 50%;
      object-fit: cover;
      background: white;
      border: 2px solid white;
      box-shadow: 0 0 6px rgba(0,0,0,0.2);
    }
    .timer {
      font-weight: 700;
      color: #ffec3d;
      background: rgba(0,0,0,0.3);
      padding: 4px 10px;
      border-radius: 20px;
      font-family: 'Courier New', Courier, monospace;
      user-select: none;
      position: relative;
      width: 90px;
      text-align: center;
      overflow: hidden;
    }
    .timer-wave {
      position: absolute;
      top: 0;
      left: -100%;
      width: 200%;
      height: 100%;
      background: linear-gradient(90deg, transparent 0%, #ffec3d 50%, transparent 100%);
      animation: wave 2s linear infinite;
      opacity: 0.6;
      pointer-events: none;
      border-radius: 20px;
      z-index: 1;
    }
    .timer-text {
      position: relative;
      z-index: 2;
    }
    @keyframes wave {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    /* Centered login header with logo */
    #login-header {
      text-align: center;
      margin: 120px 0 40px;
      user-select: none;
    }
    #login-header img {
      height: 80px;
      margin-bottom: 12px;
      filter: drop-shadow(0 0 6px rgba(75,108,183,0.8));
    }
    #login-header h1 {
      font-size: 28px;
      letter-spacing: 2px;
      color: #4b6cb7;
      text-shadow: 1px 1px 3px #d1d9e6;
      margin: 0;
      font-weight: 700;
    }
    /* Container */
    .container {
      margin-top: 20px;
      flex-grow: 1;
      padding: 30px 24px;
      max-width: 700px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 12px 24px rgba(0,0,0,0.1);
      margin-left: auto;
      margin-right: auto;
    }
    h2 {
      margin-bottom: 22px;
      color: #34495e;
      text-align: center;
      font-weight: 700;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      text-shadow: 1px 1px 3px #d1d9e6;
    }
    /* Forms & inputs */
    input[type="email"],
    input[type="password"],
    select {
      width: 100%;
      padding: 12px 15px;
      margin: 12px 0 20px 0;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s ease;
      box-sizing: border-box;
      outline-offset: 2px;
    }
    input[type="email"]:focus,
    input[type="password"]:focus,
    select:focus {
      border-color: #4b6cb7;
      box-shadow: 0 0 8px rgba(75,108,183,0.4);
    }
    /* Buttons */
    button {
      background: linear-gradient(90deg, #4b6cb7, #182848);
      border: none;
      color: white;
      font-weight: 700;
      padding: 14px;
      width: 100%;
      border-radius: 10px;
      cursor: pointer;
      font-size: 18px;
      transition: background 0.3s ease, transform 0.2s ease;
      box-shadow: 0 4px 12px rgba(75,108,183,0.5);
    }
    button:hover:not(:disabled) {
      background: linear-gradient(90deg, #182848, #4b6cb7);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(24,40,72,0.7);
    }
    button:disabled {
      background: #aaa;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }
    /* Question block */
    .question-block {
      margin-bottom: 28px;
      background: #f0f4ff;
      border-radius: 10px;
      padding: 16px 20px;
      box-shadow: inset 0 0 6px #d7e0ff;
      transition: background-color 0.3s ease;
    }
    .question-block p {
      font-weight: 600;
      font-size: 17px;
      color: #2c3e50;
      margin-bottom: 10px;
    }
    .question-block select {
      margin-top: 6px;
      border: 1.5px solid #4b6cb7;
      background: white;
      border-radius: 6px;
    }
    /* Feedback box */
    .feedback {
      margin-top: 30px;
      padding: 20px;
      border-radius: 12px;
      background: #f7f9fc;
      border: 1.5px solid #4b6cb7;
      font-size: 16px;
      color: #34495e;
      max-height: 300px;
      overflow-y: auto;
      user-select: text;
    }
    .feedback h3 {
      margin-top: 0;
      text-align: center;
      font-weight: 700;
      color: #182848;
    }
    .feedback p {
      margin: 8px 0;
    }
    #feedback-screen {
      /* added dynamically by JS */
    }
    .correct {
      color: #27ae60;
      font-weight: 700;
    }
    .wrong {
      color: #e74c3c;
      font-weight: 700;
    }
    /* Responsive */
    @media (max-width: 700px) {
      .container {
        margin: 90px 12px 30px;
        padding: 20px 16px;
      }
      button {
        font-size: 16px;
        padding: 12px;
      }
      #top-bar {
        flex-direction: column;
        align-items: flex-start;
        padding: 10px 14px;
      }
      #profile-info {
        margin-top: 8px;
        gap: 8px;
        font-size: 14px;
      }
      #logo {
        font-size: 18px;
      }
      #login-header {
        margin: 90px 12px 30px;
      }
      #login-header img {
        height: 60px;
      }
      #login-header h1 {
        font-size: 22px;
      }
    }
    /* Hidden class */
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>

  <div id="top-bar" class="hidden">
    <div id="logo">
      <img src="nssiddlogo.png" alt="Logo" />
      NS SIDD TUTORIAL
    </div>
    <div id="profile-info">
      <span id="student-name"></span>
      <img id="profile-img" src="" alt="Profile" onerror="this.style.display='none'" />
      <div class="timer">
        <div class="timer-wave"></div>
        <span class="timer-text" id="exam-timer">00:00</span>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Login header with centered logo and name -->
    <div id="login-header" class="">
      <img src="nssiddlogo.png" alt="Logo" />
      <h1>NS SIDD TUTORIAL</h1>
    </div>

    <div id="login-form">
      <h2>Student Login</h2>
      <input type="email" id="email" placeholder="Email" required />
      <input type="password" id="password" placeholder="Password" required />
      <button onclick="handleLogin()">Login</button>
    </div>

    <div id="exam-section" class="hidden">
      <h2>Welcome, <span id="welcome-name"></span></h2>
      <label for="subject-select" style="font-weight:600; color:#182848;">Select Subject:</label>
      <select id="subject-select" aria-label="Select Subject">
        <option value="">-- Choose Subject --</option>
        <option value="Graphic Designing">Graphic Designing</option>
        <option value="Basic Computer">Basic Computer</option>
      </select>
      <div id="start-exam-block" class="hidden" style="margin-top: 15px;">
        <button onclick="startExam()">Start Exam</button>
      </div>
      <div id="questions-container" class="hidden"></div>
      <button id="manual-submit-btn" class="hidden" onclick="confirmSubmit()" style="margin-top: 25px;">Submit</button>
      <div id="feedback-box" class="feedback hidden"></div>
    </div>
  </div>
<script>
  const SHEET_API_URL = 'https://script.google.com/macros/s/AKfycbx1MBfsjIJhnkm2iR2gibDAeCGYLJ2MUwNy6PseNT_ERvwyBDhtPZxHWlyQkjoMeXze/exec';

  let studentData = null;
  let examStarted = false;
  let timerInterval;
  let remainingTime = 60 * 60; // 1 hour in seconds
  let questionList = [];
  let correctAnswersMap = {};

  const questionBank = {
    "Graphic Designing": [
      { q: "What is Photoshop?", options: ["Software", "Tool", "Game"], correct: "Software" },
      { q: "Which format supports transparency?", options: ["JPG", "PNG", "BMP"], correct: "PNG" },
      { q: "Which color mode is used for printing?", options: ["RGB", "CMYK", "HSV"], correct: "CMYK" }
    ],
    "Basic Computer": [
      { q: "What does CPU stand for?", options: ["Central Processing Unit", "Computer Personal Unit", "Central Print Unit"], correct: "Central Processing Unit" },
      { q: "Which device stores data?", options: ["Monitor", "Hard Disk", "Printer"], correct: "Hard Disk" },
      { q: "What is the shortcut for copy?", options: ["Ctrl+V", "Ctrl+C", "Ctrl+X"], correct: "Ctrl+C" }
    ]
  };

  function handleLogin() {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    if (!email || !password) {
      alert('Please enter email and password.');
      return;
    }

    // For demo, allow any login; in real case, verify from server or Google Sheet
    // Simulate fetching user data
    studentData = {
      email,
      name: email.split('@')[0],
      profileImg: 'profile-placeholder.png'
    };

    // Hide login form, show top bar and exam section
    document.getElementById('login-form').classList.add('hidden');
    document.getElementById('login-header').classList.add('hidden');
    document.getElementById('top-bar').classList.remove('hidden');
    document.getElementById('exam-section').classList.remove('hidden');

    document.getElementById('student-name').textContent = studentData.name;
    document.getElementById('profile-img').src = studentData.profileImg;
    document.getElementById('welcome-name').textContent = studentData.name;
  }

  const subjectSelect = document.getElementById('subject-select');
  const startExamBlock = document.getElementById('start-exam-block');
  const questionsContainer = document.getElementById('questions-container');
  const manualSubmitBtn = document.getElementById('manual-submit-btn');
  const feedbackBox = document.getElementById('feedback-box');
  const examTimer = document.getElementById('exam-timer');

  subjectSelect.addEventListener('change', () => {
    if(subjectSelect.value) {
      startExamBlock.classList.remove('hidden');
    } else {
      startExamBlock.classList.add('hidden');
      questionsContainer.classList.add('hidden');
      manualSubmitBtn.classList.add('hidden');
      feedbackBox.classList.add('hidden');
    }
  });

  function startExam() {
    if(!subjectSelect.value) {
      alert('Please select a subject to start the exam.');
      return;
    }
    examStarted = true;
    remainingTime = 60 * 60; // reset timer to 1 hour
    startExamBlock.classList.add('hidden');
    questionsContainer.classList.remove('hidden');
    manualSubmitBtn.classList.remove('hidden');
    feedbackBox.classList.add('hidden');
    renderQuestions(subjectSelect.value);
    startTimer();
  }

  function renderQuestions(subject) {
    questionList = questionBank[subject] || [];
    correctAnswersMap = {};
    questionsContainer.innerHTML = '';
    questionList.forEach((item, index) => {
      const block = document.createElement('div');
      block.className = 'question-block';
      block.innerHTML = `
        <p><strong>Q${index + 1}:</strong> ${item.q}</p>
        <select aria-label="Answer for question ${index + 1}" data-qindex="${index}">
          <option value="">-- Select Answer --</option>
          ${item.options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
        </select>
      `;
      questionsContainer.appendChild(block);
      correctAnswersMap[index] = item.correct;
    });
  }

  function startTimer() {
    updateTimerDisplay();
    timerInterval = setInterval(() => {
      remainingTime--;
      if(remainingTime <= 0) {
        clearInterval(timerInterval);
        alert("Time's up! Your exam will be submitted automatically.");
        submitExam();
      }
      updateTimerDisplay();
    }, 1000);
  }

  function updateTimerDisplay() {
    const mins = Math.floor(remainingTime / 60).toString().padStart(2, '0');
    const secs = (remainingTime % 60).toString().padStart(2, '0');
    examTimer.textContent = `${mins}:${secs}`;
  }

  function confirmSubmit() {
    if(confirm("Are you sure you want to submit your exam?")) {
      submitExam();
    }
  }

  function submitExam() {
    clearInterval(timerInterval);
    examStarted = false;
    manualSubmitBtn.disabled = true;

    const selects = questionsContainer.querySelectorAll('select');
    let score = 0;
    let total = selects.length;
    let resultHtml = '<h3>Exam Results</h3>';

    selects.forEach(select => {
      const qIndex = parseInt(select.getAttribute('data-qindex'), 10);
      const userAnswer = select.value;
      const correctAnswer = correctAnswersMap[qIndex];
      if(userAnswer === correctAnswer) {
        score++;
        resultHtml += `<p>Q${qIndex + 1}: <span class="correct">Correct</span> (Your answer: ${userAnswer})</p>`;
      } else if(userAnswer === '') {
        resultHtml += `<p>Q${qIndex + 1}: <span class="wrong">No Answer</span> (Correct: ${correctAnswer})</p>`;
      } else {
        resultHtml += `<p>Q${qIndex + 1}: <span class="wrong">Wrong</span> (Your answer: ${userAnswer}, Correct: ${correctAnswer})</p>`;
      }
    });

    resultHtml += `<p><strong>Your Score: ${score} / ${total}</strong></p>`;
    feedbackBox.innerHTML = resultHtml;
    feedbackBox.classList.remove('hidden');
    manualSubmitBtn.classList.add('hidden');
    questionsContainer.classList.add('hidden');
  }
</script>

</body>
</html>
